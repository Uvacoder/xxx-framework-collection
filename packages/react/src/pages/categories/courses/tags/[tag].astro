---
import { startCase, kebabCase } from 'lodash'
import { courses, courseTags } from '../../../../data/courses'
import BaseLayout from '../../../../layouts/base.astro'
import { Counter } from '@framework.dev/system/src/components/counter'
import { CourseCard } from '@framework.dev/system/src/components/course-card'
import { sprinkles } from '@framework.dev/system/src/sprinkles/sprinkles.css'

export function getStaticPaths() {
	return courseTags.map(tag => ({
		params: { 
			tag: kebabCase(tag) 
		}, 
		props: { tag } 
	}))
}

const tag = Astro.props.tag as typeof courseTags[number]
const selectedCourses = courses.filter(course => course.tags.includes(tag))
const title = `React ${startCase(tag)} Courses`
---
<head>
	<meta name="description" content={`Browse ${title}`}/>
</head>
<BaseLayout title={title}>
	<header class={sprinkles({ layout: "row", alignItems: "center", gap: 8, margin: 48 })}>
		<h1 class={sprinkles({ textStyle: "pageHeading"  })}>{title}</h1>
		<Counter>{selectedCourses.length.toString()}</Counter>
	</header>
	<div class={sprinkles({ layout: "threeGrid", gap: 24 })}>
		{selectedCourses.map(course => {
			return <CourseCard course={course} headingTag="h2" />
		})}
	</div>
</BaseLayout>