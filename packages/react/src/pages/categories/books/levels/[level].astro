---
import { startCase, kebabCase } from 'lodash'
import { bookLevels } from '@framework/system/src/models/book'
import { PageHeader } from '@framework/system/src/components/page-header.tsx'
import { BookCard } from '@framework/system/src/components/book-card.tsx'
import { sprinkles } from '@framework/system/src/sprinkles/sprinkles.css'
import { books } from '../../../../data/books'
import BaseLayout from '../../../../layouts/base.astro'

export function getStaticPaths() {
	return bookLevels.map(level => ({
		params: {
			level: kebabCase(level)
		},
		props: { level }
	}))
}

const level = Astro.props.level as typeof bookLevels[number]
const selectedBooks = books.filter(book => book.level === level)
const title = `${startCase(level)} React Books`
---
<head>
	<meta name="description" content={`Browse ${title}`}/>
</head>
<BaseLayout title={title}>
	<div class={sprinkles({ layout: "landscapeCardGrid", gap: 24 })}>
		<PageHeader title={title} count={selectedBooks.length} />
		{selectedBooks.map(book => {
			return <BookCard book={book} headingTag="h2" />
		})}
	</div>
</BaseLayout>